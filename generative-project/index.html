<html>
  <head>
    <title>Generative Art Project</title>
    <style>
      canvas {
        width: 100%;
        height: 100%;
      }
    </style>
    <script>
      /*
       * Generative Platform support
       *
       * Each project can implement one or more of the following methods:
       * - `downloadAsset`- if generative platform should display a button for high quality asset download
       * - `delegatedLoading` - if generative platform should display a loader until project is ready to be displayed
       * - `previewCaptureTrigger` - if generative platform should wait for a trigger to capture a preview image
       */

      /*
       * Download Asset
       *
       * Description: Indicates to the Generative platform that Generative project implements `downloadImage` method.
       *
       * Instructions: to implement this feature add below code to your project and implement `downloadAsset` method
       * which will be called by the platform when user clicks on the download button to download a high quality asset.
       */
      //
      window.$implementsDownloadAsset = true;
      window.addEventListener("message", function (event) {
        if (event.data == "download-asset") {
          downloadAsset();
        }
      });

      /*
       * Delegated Loading
       *
       * Description: Indicates to the Generative platform that it should be responsible for showing loader UI
       * until project is ready to be displayed.
       *
       * Instructions: to implement this feature add below code to your project and call `loadingCompleted` method
       * when you want Generative Platform to stop showing loader display the project.
       */
      window.$implementsDelegatedLoading = true;
      function loadingComplete() {
        window.parent.postMessage("loading-complete", "*");
      }

      /*
       * Preview Capture Trigger
       
       * Description: Indicates to the Generative platform preview generator that Generative project
       * will trigger when to capture a preview image.
       * 
       * Instructions: to implement this feature add below code to your project and trigger `capturePreview`
       * method when you want preview image to be captured.
       */
      window.$implementsPreviewCaptureTrigger = true;
      function capturePreview() {
        dispatchEvent(new Event("capture-preview"));
      }
    </script>
    <script>
      // generative project specific logic to download an image implemented by the artist
      function downloadAsset() {
        console.log("downloading asset");

        const canvas = document.querySelector("canvas");
        const downloadButton = document.getElementById("downloadButton");
        const dataURL = canvas.toDataURL("image/png");
        const link = document.createElement("a");
        link.download = "canvas.png";
        link.href = dataURL;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }

      function draw() {
        const canvas = document.querySelector("canvas");
        const ctx = canvas.getContext("2d");

        ctx.canvas.width = window.innerWidth;
        ctx.canvas.height = window.innerWidth;
        // Create the gradient
        const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
        gradient.addColorStop(0, "red");
        gradient.addColorStop(1, "blue");

        // Fill a rectangle with the gradient
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        loadingComplete();
      }

      const interval = setInterval(() => {
        draw();
        clearInterval(interval);
      }, 2000);
    </script>
  </head>
  <body>
    <canvas></canvas>
  </body>
</html>
